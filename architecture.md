# アプリケーション技術構成

## 概要

このアプリケーションは、React（TypeScript）フロントエンドと Flask（Python）バックエンドを使用したチャットアプリケーションです。OpenAI API を活用して AI チャット機能を提供します。

## アーキテクチャ

### 全体構成

- **フロントエンド**: React + TypeScript + Vite
- **バックエンド**: Flask + Python
- **AI 機能**: OpenAI API

## フロントエンド技術スタック

### 主要技術

- **React 18.3.1**: UI ライブラリ
- **TypeScript 5.5.3**: 型安全性の確保
- **Vite v7**: 高速ビルドツール
- **React Router DOM 6.26.1**: ルーティング

### UI ライブラリ・スタイリング

- **Mantine v7**: モダンな React UI ライブラリ
- **CSS Modules**: スタイリング

### 開発ツール

- **Biome v2**: リンター・フォーマッター
- **Volta**: Node.js バージョン管理（v22）

## バックエンド技術スタック

### 主要技術

- **Flask 3.0.3**: Web フレームワーク
- **Python 3.11**: プログラミング言語
- **Flask-CORS**: CORS 対応

### AI・API

- **OpenAI API**: チャット機能
- **Pydantic**: データバリデーション

### 開発・管理ツール

- **uv**: Python パッケージ管理・仮想環境管理
- **Ruff**: リンター・フォーマッター
- **MyPy**: 型チェック
- **python-dotenv**: 環境変数管理

## プロジェクト構造

### フロントエンド構造

```
frontend/
├── src/
│   ├── components/          # 再利用可能コンポーネント
│   │   ├── Answer/          # 回答表示コンポーネント
│   │   ├── QuestionInput/   # 質問入力コンポーネント
│   │   ├── ClearChatButton/ # チャット削除
│   │   └── SettingsButton/  # 設定ボタン
│   ├── pages/
│   │   ├── chat/           # チャットページ
│   │   └── layout/         # レイアウト
│   └── api/                # API通信
└── package.json
```

### バックエンド構造

```
backend/
├── app/
│   ├── controller/         # リクエスト処理
│   ├── service/           # ビジネスロジック
│   ├── models/            # OpenAI API管理
│   ├── core/              # メッセージ構築
│   └── types/             # 型定義
├── pyproject.toml         # uvによる依存関係管理
└── uv.lock               # 依存関係ロックファイル
```

## 開発環境

### ローカル開発

- **フロントエンド**: `npm run dev`で Vite 開発サーバー起動（ポート 5173）
- **バックエンド**: `uv run python app.py`で Flask サーバー起動（ポート 5000）
- **Node.js**: v22（Volta でバージョン管理）
- **Python**: 3.11（uv で仮想環境・パッケージ管理）

### エディタ

- **Cursor/VSCode**: 推奨エディタ
- **拡張機能**: 各種開発支援ツール

## 実装済み機能

### チャット機能

- **AI チャット対話**: OpenAI API を使用したリアルタイム会話機能
- **複数モデル対応**: GPT-4o、GPT-4o-mini、Gemini モデルの選択可能
- **デモモード**: 入力した質問をそのまま返すテスト用機能（response-test）
- **会話履歴管理**: 過去の対話を保持し、連続した会話が可能

### ユーザーインターフェース

- **チャット画面**: 質問入力と AI 回答表示のメイン画面
- **設定パネル**: GPT モデル、システムプロンプト、Temperature 設定
- **質問入力**: マルチライン対応の入力フィールド（Enter 送信、Shift+Enter 改行）
- **チャット履歴表示**: ユーザーメッセージと AI 回答の会話表示
- **クリアボタン**: チャット履歴を全削除する機能

### 高度な設定機能

- **GPT モデル選択**: 4 つのモデル（response-test、gpt-4o-mini、gpt-4o、gemini）から選択
- **システムプロンプト設定**: AI の応答スタイルをカスタマイズ
- **Temperature 調整**: 0.0-1.0 の範囲で AI の創造性レベルを調整
- **設定永続化**: セッション中の設定保持

### エラーハンドリング・UX

- **ローディング表示**: AI 応答待機中のローディングアニメーション
- **エラー表示**: API 呼び出し失敗時のエラーメッセージとリトライ機能
- **レスポンシブデザイン**: Mantine v7 ベースの洗練された UI
- **キーボードショートカット**: Enter 送信、設定パネル開閉

### API 機能

- **RESTful API**: Flask 製バックエンド API
- **CORS 対応**: フロントエンドとの通信に対応
- **リクエスト検証**: 入力データの妥当性チェック
- **エラーハンドリング**: 適切な HTTP ステータスコードでのエラー応答

### 開発・品質管理

- **TypeScript による型安全性**: フロントエンド全体の型チェック
- **Biome v2/Ruff によるコード品質管理**: 自動リンティング・フォーマット
- **ローカル開発環境**: npm/uv コマンドによる直接起動

## セキュリティ対策

- 環境変数による API キー管理
- CORS 設定
- XSS 対策（DOMPurify）
- 型安全性（TypeScript/Pydantic）

## 特徴

- モダンなフロントエンド技術スタック
- 型安全なフルスタック開発
- シンプルなローカル開発環境
- AI 機能統合
- Mantine v7 による洗練された UI
